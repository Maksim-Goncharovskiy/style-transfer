**Цель экспериментов:** получить оптимальное решение с точки зрения соотношения качества/скорости. 

**Исследуемые характеристики:**
1. Среднее время генерации стилизованного изображения на CPU и GPU.
2. Потеря контента: MSELoss(G, C), где G - полученное на выходе стилизованное изображение, C - исходное изображение контента.
3. Потеря стиля: метрика Грамма между G и S, где S исходное изображение стиля.
4. Качество получаемых картинок, оцениваемое визуально.

**Оптимизируемые параметры:**
1. Количество используемых слоёв VGG-19.
2. LearningRate + NumSteps

## Глубина VGG-19
Ноутбук с экспериментом: `vgg-layers.ipynb`

**Суть эксперимента:** исследование влияния количества используемых слоев VGG-19 на качество получаемых стилизаций. Оценка среднего времени стилизации для одной пары изображений.

| <center>№</center> | vgg_depth | time_gpu | time_cpu | content_score | style_score | visual_score |
| ------------------ | --------- | -------- | -------- | ------------- | ----------- | ------------ |
| 1                  | 11 (5)    | 10.7481  | 101.113  | 0.03141       | 0.00153     | 6/10         |
| 2                  | 18 (8)    | 15.6     | 154.6685 | 0.04154       | 0.000550    | 7/10         |
| 3                  | 35 (17)   | 23.75679 | 232.12   | 0.03972       | 0.000604    | 8/10         |
Пояснение к таблице:
- vgg_depth - количество используемых первых слоев сети VGG-19. В скобках указано количество свёрток среди используемых слоев.
- visual_score - моя субъективная оценка качества стилизованного изображения, где 10 - это идеальное перенесение стиля, 1 - стиль не был перенесен. 

**Результат:** бОльшее количество слоёв VGG-19 => лучшее качество стилизации, т.к. глубокие свёрточные слои позволяют учитывать более высокоуровневые паттерны стиля.

**Решение:** взять за основу самую глубокую версию модели и постараться уменьшить время стилизации.

## LR и NumSteps
Ноутбук с экспериментом: `lr-steps.ipynb`

**Суть эксперимента:** подобрать такое минимальное количество шагов оптимизаций `num_steps`, при котором будут минимальные потери качества стилизации. 


| NumSteps | LR   | Scheduler | Gamma | time_gpu | time_cpu | best_quality | decision |
| -------- | ---- | --------- | ----- | -------- | -------- | ------------ | -------- |
| 400      | 0.05 | -         | -     | 23.75679 | 232.12   | ✅            |          |
| 100      | 0.05 | -         | -     | 6.24188  | 61.46    |              |          |
| 75       | 0.07 | + (15)    | 0.95  | 5.5115   | 48.373   |              | ✅        |
| 50       | 0.08 | + (10)    | 0.95  | 3.2888   | 34.1     | ❌            |          |

Пояснение к таблице:
- `Scheduler` - использовалось ли изменение LR в процессе оптимизации (в скобках указано через сколько шагов LR менялся)

**Решение:** в качестве решения для телеграмм бота взять вариант с 75 шагами оптимизации. 
